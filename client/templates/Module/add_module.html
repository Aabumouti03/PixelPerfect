{% extends 'users/base.html' %}
{% load static %}

{% block content %}
    <div class="content">
        <h2 class="page-title">Add New Module</h2>
        <link rel="stylesheet" href="{% static 'client/css/add_module.css' %}">

        <form method="POST" action="">
            {% csrf_token %}
            
            <!-- Module Form -->
            <div class="form-group">
                <label>Module Title</label>
                {{ module_form.title }}
            </div>

            <div class="form-group">
                <label>Module Description</label>
                {{ module_form.description }}
            </div>

            <!-- Sections -->
            <h3>Sections</h3>
            <div id="sections-container">
                <button type="button" onclick="addSection()">+ Add Section</button>
            </div>

            <button type="submit" class="save-btn">Save Module</button>
        </form>
    </div>

    <script>
        let sectionCounter = 0;
    
        function addSection() {
            let container = document.getElementById('sections-container');
            let sectionId = `section-${sectionCounter++}`;
            
            let sectionDiv = document.createElement('div');
            sectionDiv.innerHTML = `
                <div class="section">
                    <input type="text" name="section_title" placeholder="Section Title">
                    <button type="button" onclick="addExercise('${sectionId}')">+ Add Exercise</button>
                    <div class="exercises-container" id="${sectionId}"></div>
                </div>
            `;
            container.appendChild(sectionDiv);
        }
    
        function addExercise(sectionId) {
            let container = document.getElementById(sectionId);
            let exerciseId = `exercise-${Math.random().toString(36).substr(2, 5)}`;
    
            let exerciseDiv = document.createElement('div');
            exerciseDiv.innerHTML = `
                <div class="exercise">
                    <input type="text" name="exercise_title_${sectionId}" placeholder="Exercise Title">
                    <button type="button" onclick="addQuestion('${exerciseId}')">+ Add Question</button>
                    <div class="questions-container" id="${exerciseId}"></div>
                </div>
            `;
            container.appendChild(exerciseDiv);
        }
    
        function addQuestion(exerciseId) {
            let container = document.getElementById(exerciseId);
    
            let questionDiv = document.createElement('div');
            questionDiv.innerHTML = `
                <input type="text" name="question_text_${exerciseId}" placeholder="Question Text">
            `;
            container.appendChild(questionDiv);
        }
    </script>
    
{% endblock %}