{% extends 'client/client_base.html' %}
{% load static %} 
{% block title %}
    Programs
{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'client/css/programs.css' %}">
{% endblock %}

{% block content %}
    <body class="container">
        <h1>Programs</h1>

        <!-- 🔍 Search Form -->
        <form method="get" class="d-flex justify-content-center mb-4">
            <input
                type="text"
                name="q"
                class="form-control me-2"
                style="max-width: 400px;"
                placeholder="Search programs..."
                value="{{ query|default:'' }}"
            >
            <button type="submit" class="btn btn-outline-primary">Search</button>
        </form>

        <!-- 💠 Program Cards -->
        <main class="program-grid">
            {% for program in programs %}
            <div class="program-card">
                <h2>{{ program.title }}</h2>
                <p>{{ program.description|truncatewords:20 }}</p>
            
                <ul class="module-list">
                    {% for pm in program.program_modules.all %}
                        <li>{{ pm.module.title }}</li>
                    {% empty %}
                        <li>No modules assigned.</li>
                    {% endfor %}
                </ul>                
            
                <div class="buttons">
                    <a href="{% url 'program_detail' program.id %}" class="edit-btn">Edit</a>
                    <a href="{% url 'delete_program' program.id %}" class="delete-btn" onclick="return confirm('Are you sure you want to delete this program?');">Delete</a>
                </div>
            </div>
            {% empty %}
                <p>No programs available.</p>
            {% endfor %}

            <a href="{% url 'create_program' %}" class="program-card add-card">
                +
            </a>
        </main>
    </body>
{% endblock %}
